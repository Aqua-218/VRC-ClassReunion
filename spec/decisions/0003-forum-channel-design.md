# ADR 0003: フォーラムチャンネル設計

## ステータス
承認済み

## コンテキスト

お誘い募集システムのUIをどのDiscordチャンネル形式で実装するか決定する必要がある。従来のテキストチャンネル、スレッド、フォーラムチャンネルが候補。

### 要求事項
- 募集ごとに独立した議論スペース
- カテゴリタグによる分類
- ステータス管理の可視化
- 過去の募集の検索・閲覧

## 検討した選択肢

### 1. フォーラムチャンネル
- **メリット**:
  - 各募集が独立したスレッドとして作成される
  - タグシステムで自動分類可能（カテゴリ、ステータス）
  - 一覧性が高い（フォーラム投稿リスト）
  - アーカイブ機能で過去の募集も閲覧可能
  - Discord公式推奨の新機能

- **デメリット**:
  - 比較的新しい機能、一部の古いクライアントで非対応

### 2. 通常のテキストチャンネル + スレッド
- **メリット**:
  - 従来の手法、広く認知されている
  - 実装が簡単

- **デメリット**:
  - タグシステムがない、カテゴリ分類が困難
  - 情報が流れる、過去の募集が埋もれる
  - ステータス管理が手動

### 3. カテゴリごとに個別チャンネル
- **メリット**:
  - カテゴリ分けが明確

- **デメリット**:
  - チャンネル数が増加、管理が煩雑
  - ステータス管理が困難
  - ユーザーが複数チャンネルを確認する必要

## 決定内容

**フォーラムチャンネルを採用**

### 理由
1. **構造化**: 各募集が独立したスレッド、雑談が分離
2. **タグシステム**: カテゴリ（観光、ゲーム等）とステータス（募集中、定員到達等）を自動管理
3. **検索性**: フォーラム一覧で過去の募集も確認可能
4. **Discord推奨**: 公式がコミュニティ管理に推奨

### トレードオフ
- 新機能のため一部ユーザーが不慣れ → オンボーディングガイド整備
- 古いクライアント非対応 → Discord公式がサポート推奨、移行を促す

## 実装詳細

### フォーラムタグ設計

**カテゴリタグ** (排他的):
- 観光
- ゲーム
- まったり
- 撮影会
- イベント
- その他

**ステータスタグ** (排他的):
- 募集中
- 定員到達
- 開催済み
- 中止

### 自動タグ管理

```typescript
// 募集作成時
forum.threads.create({
  name: eventName,
  appliedTags: [categoryTagId, '募集中TagId'],
  // ...
});

// 定員到達時
thread.setAppliedTags([categoryTagId, '定員到達TagId']);

// 開催済み時
thread.setAppliedTags([categoryTagId, '開催済みTagId']);
```

## 影響範囲

- チャンネル構成: フォーラムチャンネル `📋-お誘い募集` を作成
- タグ管理: カテゴリ6種 + ステータス4種
- スレッド命名: イベント名をそのままスレッド名に
- アーカイブ: 開催済み・中止の募集は自動アーカイブ（オプション）

## 代替案と撤退条件

**撤退条件**:
- フォーラムチャンネルにDiscord側の重大なバグが発生した場合
  - 対策: テキストチャンネル + スレッドに一時的に切り替え
- ユーザーの大多数がフォーラム形式に反対した場合
  - 対策: アンケート実施、フィードバック収集

**代替案**:
- テキストチャンネル + スレッドに変更
  - タグ機能喪失、手動カテゴリ管理が必要

## 参考資料

- [Discord Forum Channels Guide](https://support.discord.com/hc/en-us/articles/6208479917079-Forum-Channels-FAQ)
- [discord.js Forum Channels](https://discordjs.guide/popular-topics/threads.html#forum-channels)

---

**決定日**: 2025年11月16日  
**決定者**: プロジェクトチーム  
**レビュー予定**: Phase 1 終了時（ユーザーフィードバックベース）
